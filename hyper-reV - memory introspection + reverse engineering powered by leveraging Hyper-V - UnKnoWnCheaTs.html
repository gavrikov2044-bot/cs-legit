<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="generator" content="vBulletin">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="game hacks, game cheats, free game hacks, cheat downloads, game hacking, game modding, cheat injector, game mods, hack tools, wallhack, esp cheats, undetected cheats, aimbot, modding community, hack downloads, anti-cheat bypass, cheat software, game tutorials, cheat guides, game hack forum, game cheat tools, cheat source code">

    
        
            
                
                    <meta name="description" content="Game hacks, game cheats, and game hacking. Download game hacks and game cheats, explore expert game hacking tutorials, and join the #1 game hacking community.">
                    <meta property="og:description" content="Unlock the best game hacks, game cheats, and game hacking tools. Get game free hacks, expert tutorials, and join the #1 game hacking community trusted by thousands of gamers.">
                    <meta property="og:title" content="UnKnoWnCheaTs - Game Hacking, Game Hacks & Game Cheats">
                    <meta property="og:locale" content="en_US">
                    <meta property="og:type" content="website">
                    <meta property="og:site_name" content="UnKnoWnCheaTs">
                    <meta property="og:image" content="https://www.unknowncheats.me/forum/ambience/misc/embed_small.png">
                    <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://www.unknowncheats.me/forum/index.php","name":"UnKnoWnCheaTs - Multiplayer Game Hacking and Cheats","publisher":{"@type":"Organization","name":"UnKnoWnCheaTs","logo":{"@type":"ImageObject","url":"https://www.unknowncheats.me/forum/ambience/misc/embed_small.png"}},"description":"The best site for game hacks, game cheats, and game hacking tools. Download game hacks and game cheats, explore expert game hacking tutorials, and join the #1 game hacking community."}</script>
                
            
        
    


<link rel="icon" href="https://www.unknowncheats.me/favicon.ico" type="image/x-icon">
<!-- CSS Stylesheet -->
<style type="text/css" id="vbulletin_css">
@import url("clientscript/vbulletin_css/style-ca48acdb-00033.css");
</style>
<link rel="stylesheet" type="text/css" href="https://www.unknowncheats.me/forum/clientscript/vbulletin_important.css?v=387" />
<!-- / CSS Stylesheet -->
<script src="clientscript/yui/yahoo-dom-event/yahoo-dom-event.js?v=387"></script><script src="clientscript/yui/connection/connection-min.js?v=387"></script>
<script>
<!--
var SESSIONURL = "";var SECURITYTOKEN = "1767430835-ada33cca4dceb76ce6e9bf3f93bc2ad3d696222d";var IMGDIR_MISC = "ambience/misc";var vb_disable_ajax = parseInt("0", 10);
// -->
</script>
<script src="clientscript/vbulletin_global.js?v=387"></script>
<script type="text/javascript" src="clientscript/vbulletin_menu.js?v=387"></script>

	<link rel="alternate" type="application/rss+xml" title="UnKnoWnCheaTs - Multiplayer Game Hacking and Cheats RSS Feed" href="https://www.unknowncheats.me/forum/external.php?type=RSS2">
	


<link href="https://www.unknowncheats.me/forum/clientscript/prettify/prettify.css?v=2" type="text/css" rel="stylesheet">
<script src="clientscript/prettify/run_prettify.js"></script>

<!-- dnr -->

<script async src="https://cdn.fuseplatform.net/publift/tags/2/3924/fuse.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T6SKJV5F');</script>
<!-- / dnr -->
<script>if(location.hostname!="un"+"know"+"nche"+"ats."+"me"&&location.hostname!="www"+".unkno"+"wnch"+"eats."+"me"&&location.hostname!="webcache.googleusercontent.com"){location.href="htt"+"ps:"+"//ww"+"w.unkn"+"ownc"+"heat"+"s.me";}</script><script src="//www.unknowncheats.me/forum/clientscript/uc_imageresizer.js"></script>
<style>
<!--
table.ncode_imageresizer_warning{background:#FFFFE1;color:#000;border:1px solid #CCC;cursor:pointer}table.ncode_imageresizer_warning td{font-size:10px;vertical-align:middle;text-decoration:none}table.ncode_imageresizer_warning td.td1{padding:5px;padding:2px}
-->
</style>
<script>
<!--
NcodeImageResizer.MODE='enlarge';NcodeImageResizer.MAXWIDTH=800;NcodeImageResizer.MAXHEIGHT=0;NcodeImageResizer.BBURL='https://www.unknowncheats.me/forum';vbphrase['ncode_imageresizer_warning_small']='Click this bar to view the full image.';vbphrase['ncode_imageresizer_warning_filesize']='This image has been resized. Click this bar to view the full image. The original image is sized %1$sx%2$s and weights %3$sKB.';vbphrase['ncode_imageresizer_warning_no_filesize']='This image has been resized. Click this bar to view the full image. The original image is sized %1$sx%2$s.';vbphrase['ncode_imageresizer_warning_fullsize']='Click this bar to view the small image.';
//-->
</script><link rel="stylesheet" type="text/css" href="https://www.unknowncheats.me/forum/vbshoutcss.php" />
<title>hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V - UnKnoWnCheaTs - View Single Post 4433650</title>
</head>
<body style="margin:0px" onload="self.focus()">

<form action="https://www.unknowncheats.me/forum/showpost.php">

<table class="tborder" style="width: 100%; border: 0; border-bottom-width: 0px; border-collapse: separate; border-spacing: 1px;">
<tr>
	<td class="tcat" style="padding: 6px;">
		<div class="smallfont" style="float:right">
			<strong>Thread</strong>: [Release] <a style="text-decoration: underline" href="https://www.unknowncheats.me/forum/anti-cheat-bypass/709634-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-post4433650.html#post4433650">hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V</a>
		</div>
		View Single Post
	</td>
</tr>
</table>


<script src="clientscript/vbulletin_ajax_reputation.js?v=387"></script>


<!-- post #4433650 -->


<!-- top category table setup -->
<!-- below line added by lm to hide empty block above posts, but because vb this is also used for the thread title, which is the exception 'parentid == 0' -->

<table class="tborder" cellpadding="6" cellspacing="1" style="width: 100%; margin: 0 auto; border: none;">
<thead>
<tr>
<td class="tcat" style="text-align: center;"> <strong>hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V</strong></td>
</tr>
</thead>
</table>

<!-- End top category table setup -->

<table id="post4433650" class="tborder" cellpadding="6" cellspacing="1" style="width: 100%; margin: 0 auto; border: none;">
<tr>
	
		<td class="thead" style="font-weight:normal"  id="currentPost">		
			<!-- status icon and date -->
			<a name="post4433650"><img class="inlineimg" src="ambience/statusicon/post_old.gif" alt="Old" border="0"></a>
			16th July 2025, 11:02 PM
			
			<!-- / status icon and date -->				
		</td>



		<td class="thead" style="font-weight: normal; text-align: right;">

                        &nbsp;
			

			
		</td>
	
</tr>
<tr style="vertical-align: top;">
	<td class="alt2" style="width: 200px;">
			<div id="postmenu_4433650">
				

<div style="text-align: center;">
<a class="bigusername" rel="nofollow" href="https://www.unknowncheats.me/forum/members/5315844.html">
<span style="color: #000000; font-weight: bold;">noahsx</span>
</a>
</div>
		
<script>vbmenu_register("postmenu_4433650", true);</script>

</div>


<div class="smallfont" style="text-align: center;"><font color=cyan>n00bie</font><br> <img src=star.gif></div>





	
		<div class="smallfont">
			<br>
<div style="text-align: center;">
  <a rel="nofollow" href="https://www.unknowncheats.me/forum/members/5315844.html">
    <img src="customavatars/avatar5315844_1.gif" 
         width="150" height="150" 
         alt="noahsx's Avatar" 
         style="border: 0;">
  </a>
</div>

		</div>
	

<br>

<!-- thread starter begin (lm) -->

<!-- thread starter end (lm) -->

<div class="info"><span style="color: black;">Join Date: Mar 2023</span></div>






<div class="info">
  <span style="color: black;">
    Posts: 21
  </span>
</div>
				

<div class="info">
<span style="color: black;">Reputation: <span id="repinfoRep_4433650_5315844">8883</span></span>
<br>


<span style="color: black;">Rep Power: 77</span>

<br><span id="repinfoDots_4433650_5315844"><img class="inlineimg" src="ambience/reputation/reputation_pos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_pos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_pos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_pos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_pos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"><img class="inlineimg" src="ambience/reputation/reputation_highpos.gif" alt="noahsx DEFINES UNKNOWNCHEATS" border="0"></span>
</div>

				

	
<!-- <div class="info">
<a href="https://www.unknowncheats.me/forum/album.php?u=5315844" rel="nofollow">View Picture Albums</a>
</div> -->

<!-- v3 Arcade -->

<!-- /v3 Arcade -->

<!-- awards system -->
<!-- show awards -->

<div class="info">
<fieldset class="alt">
<legend>Recognitions</legend>
<img src="images/medals/medal-motm.gif" alt="The UC Member of the Month award is a prestigious award given to a single community member on a monthly basis. Based on a vote from community members, the award is given to the forum member that has shown exemplary achievement and potential in the UnKnoWnCheaTs community, and has shown great commitment to upholding the principles upon which UnKnoWnCheaTs stands for. A member who has been awarded the Member of the Month award has been distinguished as an asset to the UnKnoWnCheaTs community." style="vertical-align: middle; border: none;">

<a rel="nofollow" href="https://www.unknowncheats.me/forum/members/5315844.html?tab=myawards#aw_issue3062"><span class="smallfont"><abbr title="Awarded: 4th August 2025">Member of the Month</abbr></span></a>

<!-- rover addition to display issue reason next to award image -->
<!-- issue reason is used for the number of times someone has gotten that award -->



<!-- winslow small addition to prevent huge motm paragraph from showing in postbit -->


  
    <span style="font-family: Verdana, sans-serif; font-size: 11px; color: #26353F;">(1)</span>
  




<br>
</fieldset>
</div>

<!-- /show awards -->
<!-- /awards system -->

 <div class="info">
<div style="text-align: left;">
	
                <table style="width: 98%;" cellpadding="0" cellspacing="0">
		<tr>
			<td><div class="smallfont">Points: 11,365, Level: 13</div></td>
		</tr>
		</table>
	
	
	
		<table style="width: 98%;" cellpadding="0" cellspacing="0">
		<tr style="background-image:url(https://www.unknowncheats.me/forum/xperience/images/red_faded.png)">
				<td style="width: 5px; height: 11px;">
<img alt="Points: 11,365, Level: 13" src="https://www.unknowncheats.me/forum/xperience/images/red_left.png" height="11"></td>
				<td style="width: 100%; height: 11px;">
<img alt="Points: 11,365, Level: 13" src="https://www.unknowncheats.me/forum/xperience/images/red.png" style="width: 18%; height: 11px;"></td>
				<td style="width: 1px; height: 11px;">
<img alt="Points: 11,365, Level: 13" src="https://www.unknowncheats.me/forum/xperience/images/red_right.png" height="11"></td>
		</tr>
		</table>
	

	
		
			<table style="width: 98%;" cellpadding="0" cellspacing="0">	
			<tr>
				<td><div class="smallfont">Level up: 29%, 935 Points needed</div></td>
			</tr>
			</table>
		
		
			<table style="width: 98%;" cellpadding="0" cellspacing="0">
			<tr style="background-image:url(https://www.unknowncheats.me/forum/xperience/images/grey_faded.png)"> 
				<td style="width: 5px; height: 11px;">
<img alt="Level up: 29%" src="https://www.unknowncheats.me/forum/xperience/images/grey_left.png" height="11"></td>
				<td style="width: 100%; height: 11px;">
<img alt="Level up: 29%" src="https://www.unknowncheats.me/forum/xperience/images/grey.png" style="width: 29%; height: 11px;"></td>
				<td style="width: 1px; height: 11px;">
<img alt="Level up: 29%" src="https://www.unknowncheats.me/forum/xperience/images/grey_right.png" height="11"></td>
			</tr>
			</table>
		
		

	
	
		<table style="width: 98%;" cellpadding="0" cellspacing="0">
			<tr>
				<td><div class="smallfont">Activity: 2.4%</div></td>
			</tr>
		</table>
	
	
	
		<table style="width: 98%;" cellpadding="0" cellspacing="0">
		<tr style="background-image:url(https://www.unknowncheats.me/forum/xperience/images/green_faded.png)"> 
			<td style="width: 5px; height: 11px;">
<img alt="Activity: 2.4%" src="https://www.unknowncheats.me/forum/xperience/images/green_left.png" height="11"></td>
			<td style="width: 100%; height: 11px;">
<img alt="Activity: 2.4%" src="https://www.unknowncheats.me/forum/xperience/images/green.png" style="width: 2.4%; height: 11px;"></td>
			<td style="width: 1px; height: 11px;">
<img alt="Activity: 2.4%" src="https://www.unknowncheats.me/forum/xperience/images/green_right.png"></td>
		</tr>
		</table>
		
</div>
</div> 
<div class="info">
<fieldset class="alt">
<legend>Last Achievements</legend>

<img class="inlineimg" style="border: 0;" width="16" height="16" src="https://www.unknowncheats.me/forum/xperience/icons/spheres_iridescent_16.png" title="First 1000 Experience Points">

</fieldset>
</div>


	</td>

	
	<td class="alt1" id="td_post_4433650">
	
	
		
			<!-- icon and title -->
			<div class="smallfont">
				
				<strong>hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V</strong>
			</div>
			<hr style="height: 1px; background-color: #181B16; border: none;">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_4433650"><b><font size="3">Contents</font></b><br />
1. Introduction<br />
2. Prior to boot<br />
3. Boot process<br />
	<blockquote>3.1. Restoration of bootmgfw.efi<br />
	3.2. Heap<br />
	3.3. Starting bootmgfw.efi<br />
	3.4. winload.efi<br />
	3.5. hvloader.dll &amp; Hyper-V launch hook<br />
		<blockquote>3.5.1. Loading hyperv-attachment</blockquote>	</blockquote>4. hyperv-attachment/post Hyper-V launch info<br />
	<blockquote>4.1. How does it support different architectures?<br />
	4.2. Entry point (pre Hyper-V launch)<br />
	4.3. First VM exit<br />
	4.4. APIC<br />
	4.5. SLAT<br />
		<blockquote>4.5.1. Code hooks on Intel<br />
		4.5.2. Code hooks on AMD<br />
		4.5.3. Code hook features common to both AMD and Intel<br />
			<blockquote>4.5.3.1. Page split/merge<br />
			4.5.3.2. Synchronization using NMIs<br />
				<blockquote>4.5.3.2.1. NMIs in host state<br />
				4.5.3.2.2. NMIs in guest state<br />
				</blockquote>			</blockquote>		</blockquote>	4.6. Returning execution to Hyper-V<br />
	4.7. Hypercalls<br />
		4.7.1 Hypercalls list &amp; descriptions<br />
	</blockquote>5. Avoiding detection<br />
6. Usermode app information<br />
	<blockquote>6.1. Command usages and descriptions list<br />
	6.2. Kernel hooks<br />
	6.3. Command aliases<br />
	6.4. Flushing logs<br />
	</blockquote>7. How to compile / use<br />
	<blockquote>7.1. 'uefi-boot' compilation<br />
	7.2. Architecture-specific compilation<br />
	7.3. Load script<br />
	7.4. Usage with Secure Boot<br />
	7.5. Usage with TPM<br />
	</blockquote>8. Source code<br />
9. Tested Windows versions<br />
10. Credits<br />
<br />
<b><font size="3">1. Introduction</font></b><br />
hyper-reV is <a rel="nofollow" href="https://hvmi.readthedocs.io/en/latest/chapters/1-overview.html" target="_blank">memory introspection</a> and reverse engineering <a rel="nofollow" href="https://www.redhat.com/en/topics/virtualization/what-is-a-hypervisor" target="_blank">hypervisor</a> powered by leveraging <a rel="nofollow" href="https://en.wikipedia.org/wiki/Hyper-V" target="_blank">Hyper-V</a>. There is also a usermode component The project provides the following abilities for the guest - meaning the Windows operating system virtualized by Hyper-V - to: read and write to guest <a rel="nofollow" href="https://wiki.osdev.org/Memory_management#Virtual_Address_Space" target="_blank">virtual memory</a> and <a rel="nofollow" href="https://wiki.osdev.org/Memory_management#Physical_Address_Space" target="_blank">physical memory</a>, translate guest virtual addresses to their corresponding guest physical addresses, <a rel="nofollow" href="https://en.wikipedia.org/wiki/Second_Level_Address_Translation" target="_blank">SLAT</a> code hooks (also known as EPT/NPT hooks), and hiding entire pages of physical memory from the guest. The fact that it leverages Hyper-V means that it will also work under systems protected by <a rel="nofollow" href="https://learn.microsoft.com/en-us/windows/security/hardware-security/enable-virtualization-based-protection-of-code-integrity?tabs=security" target="_blank">HVCI</a>.<br />
<br />
There is also a usermode component which serves as a <a rel="nofollow" href="https://en.wikipedia.org/wiki/Kernel_debugger" target="_blank">kernel debugger</a>.<br />
<br />
<b><font size="3">2. Prior to boot</font></b><br />
The 'uefi-boot' module is hyper-reV's UEFI driver. A copy of bootmgfw.efi is made. The contents of bootmgfw.efi are then replaced with the 'uefi-boot' module so that it will be executed at the next boot. The hyperv-attachment (the module inserted into Hyper-V) is also saved on disk in the same directory as bootmgfw.efi.<br />
<br />
<b><font size="3">3. Boot process</font></b><br />
<br />
<img src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26975d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-boot_process-png" border="0" alt="" onload="NcodeImageResizer.createOn(this);" /><br />
<br />
<b><font size="2">3.1. Restoration of bootmgfw.efi</font></b><br />
Once the 'uefi-boot' module is started, the original bootmgfw.efi file and any timestamp related metadata are restored to hide that the file has been tampered with. <br />
<br />
<b><font size="2">3.2. Heap</font></b><br />
A <a rel="nofollow" href="https://wiki.osdev.org/Heap" target="_blank">heap</a> is also <a rel="nofollow" href="https://wiki.osdev.org/Memory_Allocation" target="_blank">allocated</a> using <a rel="nofollow" href="https://uefi.org/specs/UEFI/2.10/07_Services_Boot_Services.html#efi-boot-services-allocatepages" target="_blank">UEFI boot_services!AllocatePages</a> (so it is 4kB aligned, rather than using <a rel="nofollow" href="https://uefi.org/specs/UEFI/2.10/07_Services_Boot_Services.html#id16" target="_blank">boot_services!AllocatePool</a> which does not guarantee that alignment).<br />
<br />
This heap is used for allocating:<br />
  - The hyperv-attachment runtime image buffer (then the hyperv-attachment file is deleted from disk as soon as it has been loaded into memory).<br />
  - The <a rel="nofollow" href="https://wiki.osdev.org/Page_Tables#48-bit_virtual_address_space" target="_blank">PML4 and PDPT</a> for the <a rel="nofollow" href="https://wiki.osdev.org/Identity_Paging" target="_blank">identity map</a> which is later used.<br />
  - The hyperv-attachment's internal heap.<br />
<br />
All of this memory is later hidden from the guest by pointing each page in guest SLAT mappings to a dummy page.<br />
<br />
<b><font size="2">3.3. Starting bootmgfw.efi</font></b><br />
The original bootmgfw.efi image is then loaded through <a rel="nofollow" href="https://uefi.org/specs/UEFI/2.10/07_Services_Boot_Services.html#id37" target="_blank">UEFI boot_services!LoadImage</a>. A hook on bootmgfw.efi!ImgpLoadPEImage (a routine which loads a portable executable image) is applied. bootmgfw.efi is started using <a rel="nofollow" href="https://uefi.org/specs/UEFI/2.10/07_Services_Boot_Services.html#id38" target="_blank">UEFI boot_services!StartImage</a>.<br />
<br />
<b><font size="2">3.4. winload.efi</font></b><br />
Once the winload.efi image is being loaded by bootmgfw.efi, it is intercepted by the bootmgfw.efi!ImgpLoadPEImage hook. The bootmgfw.efi hooks are then fully removed before applying a hook to winload.efi!ImgpLoadPEImage. This winload.efi!ImgpLoadPEImage hook allows the loading of hvloader.dll to be intercepted once winload.efi loads it.<br />
<br />
<b><font size="2">3.5. hvloader.dll &amp; Hyper-V launch</font></b><br />
Once the loading of hvloader.dll is intercepted via the winload.efi!ImgpLoadPEImage hook, a hook is applied deep in the Hyper-V launch routine within hvloader.dll after removing the hooks on winload.efi. Below is a stripped down decompilation of the Hyper-V launch routine that is hooked (it is called within hvloader.dll!HvlLaunchHypervisor):<br />
<br />

<div style="margin:20px; margin-top:5px">

	<div class="smallfont" style="margin-bottom:2px">Code:</div>
	<pre class="prettyprint linenums" dir="ltr" style="


		margin: 0px;
		max-height: 98px;
		text-align: left;
		overflow: auto">void __fastcall hv_launch(std::uint64_t hyperv_cr3, std::uint8_t* hyperv_entry_point, std::uint8_t* entry_point_gadget, std::uint64_t guest_kernel_cr3)
{
	__writecr3(guest_kernel_cr3);
	__asm { jmp entry_point_gadget }
}</pre>
</div>
This hooked Hyper-V launch routine will jump to a gadget which will end up in Hyper-V's entry point. The parameters are as follows:<br />
  - rcx = a CR3 which Hyper-V copies certain PML4es from.<br />
  - rdx = the virtual address of the relocated Hyper-V's entry point.<br />
  - r8 = the address of the gadget which jumps to Hyper-V's entry point.<br />
  - r9 = the guest's kernel CR3 (e.g. 0x1AE000 on Windows 11 24H2).<br />
<br />
<b><font size="2">3.5.1. Loading hyperv-attachment</font></b><br />
Continuing with the hook, a PML4e is inserted into the CR3 held in rcx. This PML4e contains an identity map of host physical memory. The physical memory backing the hyperv-attachment is also mapped in by this identity map, so there is a valid virtual mapping of the hyperv-attachment in Hyper-V's address space. The loaded hyperv-attachment image is <a rel="nofollow" href="https://sabotagesec.com/pe-relocation-table/" target="_blank">relocated</a> by (virtual base of the PML4e/identity map + physical base address of hyperv-attachment image). This relocation means that the hyperv-attachment will be able to execute under Hyper-V's address space once it is launched.<br />
<br />
As          @<a href="https://www.unknowncheats.me/forum/members/3608044.html" target="_blank">Iraq1337</a> described in <a href="https://www.unknowncheats.me/forum/4323297-post8.html" target="_blank">his post</a>, there are a few copies of Hyper-V in physical memory which are not SLAT protected (the guest can read them). Only the final Hyper-V image buffer is hidden from the guest. In the hypervisor launch hook, rdx holds a virtual address backing the final image buffer, which WILL be SLAT protected, so patches can be applied to it without them being disclosed to the guest. In the launch routine hook, a hook is placed on Hyper-V's VM exit handler, pointing it to a code cave where a <a rel="nofollow" href="https://www.felixcloutier.com/x86/jmp" target="_blank">far/long jump instruction</a> will detour to the hyperv-attachment's VM exit handler. All of this is done after the Hyper-V launch routine hook is removed.<br />
<br />
<b><font size="3">4. hyperv-attachment/post Hyper-V launch info</font></b><br />
<br />
<b><font size="2">4.1. How does it support different architectures?</font></b><br />
The hyperv-attachment supports both Intel and AMD. This is possible through some abstraction of architecture-specific code and a few #ifdefs, meaning both architectures are supported in the same codebase. The steps to compile the hyperv-attachment for Intel or AMD are described in '7. How to compile / use'.<br />
<br />
<b><font size="2">4.2. Entry point (pre Hyper-V launch)</font></b><br />
The hyperv-attachment's entry point is called in the Hyper-V launch detour and does the following:<br />
  - Sets up a heap manager.<br />
  - Sets up initial SLAT context allocations.<br />
  - Sets up processor state logs context.<br />
  - Intakes some info from the uefi-boot image module for later usage (e.g. the physical base address and size of the uefi-boot image).<br />
<br />
Host (the hypervisor running on the hardware which controls the guest) physical memory is accessed by the hyperv-attachment through the identity map that was set up before.<br />
<br />
<b><font size="2">4.3. First VM exit</font></b><br />
In the first VM exit, the hyperv-attachment does the following:<br />
  - Sets up a NMI (<a rel="nofollow" href="https://wiki.osdev.org/Non_Maskable_Interrupt" target="_blank">non maskable interrupt</a>) handler in Hyper-V's global IDT (<a rel="nofollow" href="https://wiki.osdev.org/Interrupt_Descriptor_Table" target="_blank">interrupt descriptor table</a>).<br />
  - Sets up the APIC (<a rel="nofollow" href="https://wiki.osdev.org/APIC" target="_blank">Advanced Programmable Interrupt Controller</a>), which is later used to fire NMIs to all host logical processors to synchronize SLAT caches.<br />
  - Nulls out the uefi-boot image to prevent the guest from searching for it.<br />
<br />
Some processes cannot be done in the first VM exit (especially ones relating to SLAT), as Hyper-V has not fully finished initializing yet. After a certain amount of VM exits have taken place, the hyperv-attachment hides the heap (the one that was set up originally in the uefi-boot image) via SLAT. The hidden uefi-boot heap memory includes hyperv-attachment's internal heap, image allocation and identity map page table structures that were allocated. This is achieved by setting the page frame numbers of all the <a rel="nofollow" href="https://wiki.osdev.org/Page_Tables" target="_blank">page table entries</a> to that of a free dummy page in the heap.<br />
<br />
<b><font size="2">4.4. APIC</font></b><br />
At the first VM exit, basic information of <a rel="nofollow" href="https://wiki.osdev.org/APIC" target="_blank">APIC</a> is fetched through the 'APIC base' located at the <a rel="nofollow" href="https://wiki.osdev.org/Model_Specific_Registers" target="_blank">MSR</a> 0x1B. If APIC is already enabled, then it is checked whether xAPIC or x2APIC is used. If APIC is not already enabled, then the highest possible version of APIC is enabled. For xAPIC, the ICR (interrupt command register) can be accessed through its host physical address at the <a rel="nofollow" href="https://wiki.osdev.org/APIC#Local_APIC_configuration" target="_blank">Local APIC</a>. For x2APIC, the ICR is accessed through the MSRs representing the Local APIC.<br />
<br />
Through the ICR, commands can be sent to the Local APIC. This is later used to send Non Maskable Interrupts to all processors but the currently executing one by formulating an ICR request. Later on in the post, it is described how those NMIs are used for synchronizing SLAT code hooks (EPT/NPT hooks).<br />
<br />
<b><font size="2">4.5. SLAT</font></b><br />
A SLAT CR3 is a <a rel="nofollow" href="https://wiki.osdev.org/CPU_Registers_x86#CR3" target="_blank">CR3</a> which describes SLAT/translations of guest physical memory to host physical memory.<br />
<br />
The SLAT <a rel="nofollow" href="https://stackoverflow.com/questions/467557/what-is-meant-by-the-term-hook-in-programming" target="_blank">code hooks</a> were implemented as follows:<br />
<br />
<b><font size="2">4.5.1. Code hooks on Intel</font></b><br />
<img src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26974d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-intel_slat_violation-png" border="0" alt="" onload="NcodeImageResizer.createOn(this);" /><br />
<br />
There is only 1 <a rel="nofollow" href="https://en.wikipedia.org/wiki/Second_Level_Address_Translation#Extended_Page_Tables" target="_blank">EPT</a> pointer (Intel's SLAT CR3), shared by all logical processors in Hyper-V.<br />
<br />
The access permissions of the target page to hook to are set --x (non readable, non writable, but is executable) and the page frame number to that of the shadow page (the page which is used for execution with its contents concealed from the guest).<br />
<br />
If a read or write occurs in the guest to the hooked page, an EPT violation will be raised. In the EPT violation handler, the original page frame number is restored and the permissions are set to rw- (is readable, is writable, but is non executable).<br />
<br />
In case of execution of the page again, these changes are reverted and vice versa.<br />
<br />
<b><font size="2">4.5.2. Code hooks on AMD</font></b><br />
<img src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26973d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-amd_slat_violation-png" border="0" alt="" onload="NcodeImageResizer.createOn(this);" /><br />
<br />
AMD's SLAT implementation is called <a rel="nofollow" href="https://en.wikipedia.org/wiki/Second_Level_Address_Translation#Rapid_Virtualization_Indexing" target="_blank">NPT</a>.<br />
<br />
Although Hyper-V shares one nested CR3 (AMD's SLAT CR3 which is similar to Intel's EPT pointer) over all logical processors, due there being no ability to have execute only pages on AMD, the implementation is vastly different.<br />
<br />
As there is no 'read access' bit in the page table entries, execute-only pages are not possible in AMD through NPT. So in the first VM exit, an identity map of host physical memory is created (mapped in <a rel="nofollow" href="https://wiki.osdev.org/Page_Tables" target="_blank">2mB large PDes</a>), which is nearly a copy of the Hyper-V nested CR3. This identity map will be known as the hook nested CR3, as it will describe what physical pages the guest can access when it is executing a hooked page.<br />
<br />
In the hook nested CR3, all non-hooked pages are set as non executable, meaning it can only execute the pages that are hooked.<br />
<br />
When a hook is added, the following happens to the target page:<br />
  - The page is set to non-executable in the Hyper-V nested CR3 (so it CAN NOT execute under the Hyper-V nested CR3).<br />
  - In the hook nested CR3 the page is made executable (so it CAN execute under the hook nested CR3).<br />
  - In the hook nested CR3 the page frame number is set to that of the shadow page.<br />
<br />
When the hooked page is executed under the Hyper-V nested CR3, a <a rel="nofollow" href="https://tandasat.github.io/Hypervisor-101-in-Rust/memory-virtualization/nested-page-fault.html" target="_blank">nested page fault</a> is raised as the hooked page is non executable in that nested CR3. In the nested page fault handler, the nested CR3 is set to the hook nested CR3. When execution is returned to the guest, the hooked page is now executable (and executing the shadow page with the 'hidden contents').<br />
<br />
Once execution reaches a non-hooked page when under the hook nested CR3 (signaled by a nested page fault caused by execution of any non-hooked page), the nested CR3 is reverted to the Hyper-V nested CR3 and execution can continue as normal until a hooked page is executed again.<br />
<br />
When a page is hooked, the page before and after the target page are set to be executable in the hook nested CR3. This prevents issues where there are instructions split over the page boundary of a hooked page (as suggested by          @<a href="https://www.unknowncheats.me/forum/members/3877221.html" target="_blank">papst</a>uc).<br />
<br />
To get the <a rel="nofollow" href="https://blog.back.engineering/04/08/2022/#virtual-machine-control-block-vmcb---parts" target="_blank">VMCB</a>,          @<a href="https://www.unknowncheats.me/forum/members/3608044.html" target="_blank">Iraq1337</a> gave example code of how he does it and the setting up of the hook nested CR3. He also explained the logic behind NPT hooks.<br />
<br />
<b><font size="2">4.5.3. Code hook features common to both AMD and Intel</font></b><br />
<br />
<b><font size="2">4.5.3.1. Page split/merge</font></b><br />
If a large page has to be split (<a rel="nofollow" href="https://wiki.osdev.org/Page_Tables#48-bit_virtual_address_space" target="_blank">PDe or PDPTe</a>), to be able to get a <a rel="nofollow" href="https://wiki.osdev.org/Page_Tables#48-bit_virtual_address_space" target="_blank">PTe</a> to represent the target 4kB guest physical page to hook, those entries are merged back together when the hook is removed (if no other hooks are in that merge range).<br />
<br />
This is done to save some heap memory that was used to allocate those lower paging structures and it also improves SLAT performance. The hook_entry_t linked list structure which is used to describe a SLAT code hook fits in just 16 bytes, allowing 256 EPT/NPT hooks to be described in just 4kB.<br />
<br />
<b><font size="2">4.5.3.2. Synchronization using NMIs</font></b><br />
APIC is used to send NMIs to all host logical processors to invalidate SLAT caches. This is paired with a bitmap signaling what logical processors need to invalidate their caches. This was done as there was an issue with synchronization of hooks (where          @<a href="https://www.unknowncheats.me/forum/members/3877221.html" target="_blank">papst</a>uc suggested to synchronize the SLAT caches). Once a logical processor receives the NMI, the following will happen depending on if the processor was in host or guest state:<br />
<br />
<b><font size="2">4.5.3.2.1. NMIs in host state</font></b><br />
If the processor was in host state when the NMI hit the processor, it will be delivered to the handler described in the IDT of the host. In the interrupt entry, <a rel="nofollow" href="https://wiki.osdev.org/CPU_Registers_x86-64" target="_blank">all general purpose and XMM registers</a> are saved on the stack before calling the NMI processor function. The NMI processor function clears the SLAT cache if it was signaled to be cleared in the bitmap.<br />
<br />
The reason why the SLAT cache is not always cleared in every NMI is because <a rel="nofollow" href="https://forum.osdev.org/viewtopic.php?p=345109#p345109" target="_blank">Hyper-V uses NMIs for inter processor communication</a>. That is why there is a bitmap which signals if a logical processor still requires a cache flush.<br />
<br />
Once the NMI processor returns, all of the general purpose and XMM registers are restored to their original values. After this, the hyperv-attachment's NMI handler jumps to the original NMI handler that Hyper-V had set up in the IDT (or return from the interrupt directly if there was no handler set up by Hyper-V for some reason).<br />
<br />
Host NMIs are not currently handled in AMD, but it makes little difference as there are many frequent guest NMI exits which the hyperv-attachment can use to flush the SLAT cache. Intel handles both host and guest-exiting NMIs.<br />
<br />
<b><font size="2">4.5.3.2.2. NMIs in guest state</font></b><br />
If the processor was in a guest state when the NMI hit the processor, the guest will VM exit with a reason of a 'physical NMI' and the same NMI processor function is called from the VM exit handler with no need to preserve registers.<br />
<br />
<b><font size="2">4.6. Returning execution to Hyper-V</font></b><br />
If a VM exit is not handled by the hyperv-attachment, execution is transferred to Hyper-V's original VM exit handler.<br />
<br />
<b><font size="2">4.7. Hypercalls</font></b><br />
The hyperv-attachment exposes <a rel="nofollow" href="https://wiki.xenproject.org/wiki/Hypercall" target="_blank">hypercalls</a> for the guest to make. The project monitors the usage of the <a rel="nofollow" href="https://wiki.osdev.org/CPUID" target="_blank">CPUID instruction</a> to process hypercalls from the guest. When the execution of a CPUID instruction happens in the guest, a VM exit occurs. In its CPUID handler, the hyperv-attachment checks if it is a valid hypercall coming from hyper-reV (through some unique values in registers). If it is not a valid hypercall coming from hyper-reV, execution is returned to Hyper-V (as mentioned in 4.6).<br />
<br />
<b><font size="2">4.7.1. Hypercalls list &amp; descriptions</font></b><br />
guest_physical_memory_operation - read / write guest physical memory<br />
guest_virtual_memory_operation - read / write guest virtual memory<br />
translate_guest_virtual_address - translate a guest virtual address to a guest physical address<br />
read_guest_cr3 - get the current guest CR3<br />
add_slat_code_hook - add a SLAT code hook<br />
remove_slat_code_hook - remove a SLAT code hook<br />
hide_guest_physical_page - hide a guest physical page from the guest<br />
log_current_state - log the current processor state in a trap frame, logs can be flushed later<br />
flush_logs - flush all the logs to a guest virtual buffer<br />
get_heap_free_page_count - get the amount of free pages left in hyperv-attachment's heap<br />
<br />
<b><font size="3">5. Avoiding detection</font></b><br />
One of the main goals of this project is to avoid the detection vectors that other similar projects have. By allocating the hyperv-attachment independently from the Hyper-V image, the project evades the detection of memory allocations located after the Hyper-V image allocation being shifted by the size of the inserted image.<br />
<br />
In addition, the project only applies hooks to the final Hyper-V image protected by SLAT. This avoids the detection of a guest searching for copies of the Hyper-V image (e.g. one from when it is initially loaded from disk) which are not protected by SLAT. Furthermore, bootmgfw.efi's (Windows' bootloader which is replaced prior to boot with the uefi-boot.efi module) original file metadata (e.g. time modified) is restored to hide that it has been tampered with.<br />
<br />
<b><font size="3">6. Usermode app information</font></b><br />
The usermode app serves as a kernel debugger, as well as an example of what can be achieved with the project's capabilities. It has many 'commands' you may execute through the command line interface. The app uses CLI11 for command parsing. <br />
<br />
<b><font size="2">6.1. Command usages and descriptions list</font></b><br />
rgpm - reads memory from a given guest physical address.<br />
Usage: rgpm physical_address size<br />
<br />
wgpm - writes memory to a given guest physical address<br />
Usage: wgpm physical_address value size<br />
<br />
cgpm - copies memory from a given source to a destination (guest physical addresses)<br />
Usage: cgpm destination_physical_address source_physical_address size<br />
<br />
gvat - translates a guest virtual address to its corresponding guest physical address, with the given guest CR3 value<br />
Usage: gvat virtual_address CR3<br />
<br />
rgvm - reads memory from a given guest virtual address (when given the corresponding guest CR3 value)<br />
Usage: rgvm virtual_address CR3 size<br />
<br />
wgvm - writes memory from a given guest virtual address (when given the corresponding guest CR3 value)<br />
Usage: wgvm virtual_address CR3 value size<br />
<br />
cgvm - copies memory from a given source to a destination (guest virtual addresses) (when given the corresponding guest CR3 values)<br />
Usage: cgvm destination_virtual_address destination_CR3 source_virtual_address source_CR3 size<br />
<br />
akh - add a hook on specified kernel code (given the guest virtual address) (asmbytes in form: 0xE8 0x12 0x23 0x34 0x45)<br />
Usage: akh [OPTIONS] virtual_address<br />
Example: akh ntoskrnl.exe!PsLookupProcessByProcessId --monitor --asmbytes 0x90 0x90 --post_original_asmbytes 0x90<br />
Options:<br />
--asmbytes<br />
--post_original_asmbytes<br />
--monitor<br />
<br />
rkh - remove a previously placed hook on specified kernel code (given the guest virtual address)<br />
Usage: rkh virtual_address<br />
<br />
gva - get the numerical value of an alias<br />
Usage: gva alias_name<br />
<br />
hgpp - hide a physical page's real contents from the guest<br />
Usage: hgpp physical_address<br />
<br />
fl - flush trap frame logs from hooks<br />
Usage: fl<br />
<br />
hfpc - get hyperv-attachment's heap free page count<br />
Usage: hfpc<br />
<br />
lkm - print list of loaded kernel modules<br />
Usage: lkm<br />
<br />
kme - list the exports of a loaded kernel module (when given the name)<br />
Usage: kme module_name<br />
<br />
dkm - dump kernel module to a file on disk<br />
Usage: dkm module_name output_directory<br />
<br />
<b><font size="2">6.2. Kernel hooks</font></b><br />
On startup, the app finds a suitable page in ntoskrnl.exe (the main Windows kernel image) to use as the 'detour holder'. This is where the original bytes of the hooked routine that have been overwritten by the <a rel="nofollow" href="https://www.codereversing.com/archives/592" target="_blank">inline hook</a> on the shadow page will reside.<br />
<br />
By using a pre-existing page, a new kernel executable page does not have to be allocated (which would have been suspicious to some security tools had an unknown kernel page being caught executing). This page is SLAT hooked so the executable contents will be hidden from the guest.<br />
<br />
This page from ntoskrnl.exe might not typically be executed, so it may be wiser to load an unused kernel driver that will not be actively executing, and use a random page from its .text section as the detour holder instead.<br />
<br />
Utilizing SLAT code hooks, kernel routines can be hooked with the usermode app. This is done by applying an inline hook on the shadow page, which then jumps to a location holding the original bytes, a typical detour.<br />
<br />
The command allows the user to specify some assembly (in hex form) to be executed either before/after the original bytes execute (via --asmbytes / --post_original_asmbytes in command arguments), as well as making the hooked routine log the processor state whenever it is executed (via --monitor in the command arguments).<br />
<br />
Unlike most other hypervisor assisted debuggers, this project fully resolves <a rel="nofollow" href="https://wiki.osdev.org/X86-64_Instruction_Encoding#RIP/EIP-relative_addressing" target="_blank">rip relative operands</a> to their absolute values. This means that the user can place hooks on a routine where the original bytes have rip relative operands (e.g. jz 50 or relative call/jmp to a routine). This also resolves rip relative memory accesses (e.g. cmp [rip+x], 0).<br />
<br />
<b><font size="2">6.3. Command aliases</font></b><br />
The usermode app also parses all loaded kernel modules, so the user can reference a module's exports or base address by name (e.g. ntoskrnl.exe!PsLookupProcessByProcessId or ntoskrnl.exe). In addition, the current CR3 that the process executes under can be referenced using 'current_cr3'.<br />
<br />
<b><font size="2">6.4. Flushing logs</font></b><br />
The logs <a rel="nofollow" href="https://wiki.osdev.org/CPU_Registers_x86-64" target="_blank">capture general purpose registers (from rax-r15)</a>, the <a rel="nofollow" href="https://wiki.osdev.org/CPU_Registers_x86#Pointer_Registers" target="_blank">rip</a>, the CR3, and a snapshot of <a rel="nofollow" href="https://wiki.osdev.org/Stack" target="_blank">the stack</a>.<br />
<br />
These logs are generated by placing the '--monitor' flag on the kernel hook command. This way, when the hook is executed, it calls to the hypervisor to log the processor state each time. When the logs are flushed using the 'fl' / flush logs command in the usermode app, it looks as follows:<br />
<br />
0. rip=0xFFFFF8049B0BA5E6 rax=0x3 rcx=0x538<br />
rdx=0xFFFFAF869BF2F260 rbx=0x0 rsp=0xFFFFAF869BF2F208 rbp=0xFFFFAF869BF2F360<br />
rsi=0x80 rdi=0x538 r8=0xFFFFAF869BF2F5A0 r9=0xFFFFE486C68FA800<br />
r10=0xFFFFF8049B0BA5E0 r11=0xFFFFAF869BF2F458 r12=0xFFFFF8042D693000 r13=0xFFFFE486CD91E000 r14=0xFFFFAF869BF2F2A8<br />
r15=0x0 CR3=0x1B473C000<br />
<br />
stack data:<br />
  0xFFFFF8042D6A7724<br />
  0x0<br />
  0x8<br />
  0xFFFF3B4D56ACD14A<br />
  0x0<br />
<br />
<b><font size="3">7. How to compile / use</font></b><br />
<br />
<b><font size="2">7.1. 'uefi-boot' compilation</font></b><br />
To compile the uefi-boot module, you must install NASM (<a rel="nofollow" href="https://nasm.us" target="_blank">https://nasm.us</a>) and &quot;check that the environment variable NASM_PREFIX is correctly set to NASM installation path&quot; (quoted from VisualUefi's Installation).<br />
<br />
All submodules must be cloned (Alex Ionescu's EDK2 and OpenSSL). They will reside in 'uefi-boot\ext'.<br />
<br />
Here are the commands to execute in the root directory of the project for cloning the required submodules (ensure git is installed):<br />
<br />

<div style="margin:20px; margin-top:5px">

	<div class="smallfont" style="margin-bottom:2px">Code:</div>
	<pre class="prettyprint linenums" dir="ltr" style="


		margin: 0px;
		max-height: 50px;
		text-align: left;
		overflow: auto">git clone --branch OpenSSL_1_1_0-stable <a rel="nofollow" href="https://github.com/openssl/openssl.git" target="_blank">https://github.com/openssl/openssl.git</a> uefi-boot/ext/openssl
git clone <a rel="nofollow" href="https://github.com/ionescu007/edk2.git" target="_blank">https://github.com/ionescu007/edk2.git</a> uefi-boot/ext/edk2/src</pre>
</div>
Alternatively, use the .gitmodules file located in the root directory.<br />
<br />
In addition, you must build the EDK2 libraries by opening uefi-boot\ext\edk2\build\EDK-II.sln and building the entire solution.<br />
<br />
<b><font size="2">7.2. Architecture-specific compilation</font></b><br />
The hyperv-attachment must be selected to be built for either Intel or AMD.<br />
<br />
To compile the hyperv-attachment for Intel: #define _INTELMACHINE in arch_config.h (which is in the hyperv-attachment src directory).<br />
<br />
To compile for AMD, simply comment that aforementioned #define line out and rebuild. <br />
<br />
The binaries of the uefi-boot module and usermode app will work for both Intel and AMD no matter the configuration specified in the hyperv-attachment.<br />
<br />
<b><font size="2">7.3. Load script</font></b><br />
There is a script ('load-hyper-reV.bat') in the root directory of the project which will place the uefi-boot module and the hyperv-attachment in the EFI partition when ran as administrator in the same directory as the uefi-boot.efi and the hyperv-attachment.dll files. Once you run this, hyper-reV will load at the next boot.<br />
<br />
<b><font size="2">7.4. Usage with Secure Boot</font></b><br />
To load the project with <a rel="nofollow" href="https://access.redhat.com/articles/5254641" target="_blank">secure boot</a> enabled, a vulnerable <a rel="nofollow" href="https://wiki.osdev.org/Bootloader" target="_blank">bootloader</a> could be exploited, as described in <a rel="nofollow" href="https://habr.com/articles/446238/" target="_blank">this post</a>.<br />
<br />
<b><font size="2">7.5. Usage with TPM</font></b><br />
If evading an advanced security tool, it is not recommend to run the project with <a rel="nofollow" href="https://en.wikipedia.org/wiki/Trusted_Platform_Module" target="_blank">TPM</a> enabled if the security tool performs <a rel="nofollow" href="https://learn.microsoft.com/en-us/azure/attestation/tpm-attestation-concepts" target="_blank">boot attestation</a>. This is because it can see that the uefi-boot binary was loaded (through info stored in the TPM PCRs or through <a rel="nofollow" href="https://learn.microsoft.com/en-us/azure/security/fundamentals/measured-boot-host-attestation" target="_blank">measured boot</a> logs). This paragraph's information is from <a title="MeasuredBoot and TPM" href="anti-cheat-bypass/623028-measuredboot-tpm.html" target="_blank">Zepta's post</a>.<br />
<br />
<b><font size="3">8. Source code</font></b><br />
The source code can be found on <a rel="nofollow" href="https://www.unknowncheats.me/forum/downloads.php?do=file&amp;id=50446" target="_blank">UC downloads</a>.<br />
<br />
<fieldset style="border:2px solid #000080;padding:6px;font-weight:bold;margin-left:15px;margin-right:15px;background:#B0E0E6;">
<legend style="border:2px solid #000080;color:#000080;margin-bottom:5px;font-weight:bold;padding:2px;background:#B0E0E6;">&nbsp;Moderator note&nbsp;</legend>
<img style="float:left; margin-right: 10px;" src="images/icons/mod_excla.png" />Use GitHub at your own risk
</fieldset><br />
Or on GitHub: <a rel="nofollow" href="https://github.com/noahware/hyper-reV" target="_blank">https://github.com/noahware/hyper-reV</a><br />
<br />
<b><font size="3">9. Tested Windows versions</font></b><br />
The project has been tested on the following versions on both Intel and AMD:<br />
<br />
Windows 10 21H2, Windows 10 22H2, Windows 11 22H2, Windows 11 23H2, Windows 11 24H2.<br />
<br />
Ensure the latest minor updates for those major Windows versions are applied if the project does not work. The system must also be able to run Hyper-V.<br />
<br />
<b><font size="3">10. Credits</font></b><br />
          @<a href="https://www.unknowncheats.me/forum/members/3608044.html" target="_blank">Iraq1337</a> - invaluable advice, especially with AMD theory, examples of nested CR3 identity mapping and a way to get the VMCB. In addition, he also suggested to apply patches to Hyper-V right before it launches.<br />
<br />
          @<a href="https://www.unknowncheats.me/forum/members/3877221.html" target="_blank">papst</a>uc - crucial advice, especially for the suggestion of synchronizing EPT/NPT cache across all processors, his idea for AMD NPT hooks on page splits and his Windows file format parsing library used in the usermode app.<br />
<br />
mylostchristmas - found that the prior method of allocating SLAT protected SLAB pages via winload.efi's SLAB allocator did not function the same way on 24H2. This functionality was then removed from the project and replaced with in-house SLAT protection.</div>
		<!-- / message -->

 		
 		

		
		<!-- attachments -->
			<div style="padding:6px">
			
			
				<fieldset class="fieldset">
					<legend>Attached Thumbnails</legend>
					<div style="padding:3px">
					
<a href="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26973d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-amd_slat_violation-png" rel="Lightbox_4433650" id="attachment26973" target="_blank"><img class="thumbnail" src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26973d1752691937t-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-amd_slat_violation-png" border="0" alt="hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V-amd_slat_violation-png" /></a>
&nbsp;

<a href="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26974d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-intel_slat_violation-png" rel="Lightbox_4433650" id="attachment26974" target="_blank"><img class="thumbnail" src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26974d1752691937t-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-intel_slat_violation-png" border="0" alt="hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V-intel_slat_violation-png" /></a>
&nbsp;

<a href="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26975d1752691937-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-boot_process-png" rel="Lightbox_4433650" id="attachment26975" target="_blank"><img class="thumbnail" src="https://www.unknowncheats.me/forum/attachments/anti-cheat-bypass/26975d1752691937t-hyper-rev-memory-introspection-reverse-engineering-powered-leveraging-hyper-boot_process-png" border="0" alt="hyper-reV - memory introspection + reverse engineering powered by leveraging Hyper-V-boot_process-png" /></a>
&nbsp;

					</div>
				</fieldset>
			
		
			
			
			
			
			
			
			
			
			</div>
		<!-- / attachments -->
		
		
		<!-- sig -->		
		
		<!-- / sig -->
		

		<!-- edit note -->
			<div class="smallfont">
                                <hr style="height: 2px; background-color: #181B16; border: none;">
				<em>
					
						Last edited by Snowyy; 20th July 2025 at <span class="time">01:42 AM</span>.
					
					
						Reason: github
					
				</em>
			</div>
		<!-- / edit note -->
		
	
	</td>
</tr>
<tr>
	<td class="alt2">
	<div style="text-align: center;"><span class="smallfont">



<span style="color: #FF7800; font-weight: bold;">noahsx is online now</span>



</span></div>
        
        <div style="text-align: center;">
            <span class="smallfont">Last Active: Today</span>
        </div>
        <br>
        

<div style="text-align: center;">
	
	
</div>
		
	</td>
	
	<td class="alt1" style="text-align: right;">
	
		<!-- controls -->



    
          <span id="reputationmenu_4433650">
              <a href="https://www.unknowncheats.me/forum/reputation.php?p=4433650" rel="nofollow" id="reputation_4433650-pos"><img src="ambience/buttons/rep_button_pos.png" alt="Add to noahsx's Reputation" /></a>	                
              <a href="https://www.unknowncheats.me/forum/reputation.php?p=4433650&amp;isNegative=1" rel="nofollow" id="reputation_4433650-neg"><img src="ambience/buttons/rep_button_neg.png" alt="Take from noahsx's reputation." /></a>
           </span>
        <script type="text/javascript">vbrep_register("4433650")</script>
    

<a href="https://www.unknowncheats.me/forum/report.php?p=4433650" rel="nofollow"><img src="ambience/buttons/report.png" alt="Report Post" border="0" /></a>

		
		   


		

<!-- 
<a href="https://www.unknowncheats.me/forum/report.php?p=4433650" rel="nofollow"><img src="ambience/buttons/report_button.gif" alt="Report Post" border="0" /></a>
-->


<a href="https://www.unknowncheats.me/forum/newreply.php?do=newreply&amp;p=4433650" rel="nofollow"><img src="ambience/buttons/quote.gif" alt="Reply With Quote" title="Reply With Quote" border="0" /></a>
		

		
		
		
		
			
			
		<!-- / controls -->
	</td>
</tr>
</table>

<!-- post 4433650 popup menu -->
<div class="vbmenu_popup" id="postmenu_4433650_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" style="border: 0;">
	<tr>
		<td class="thead">noahsx</td>
	</tr>


	
		<tr><td class="vbmenu_option"><a rel="nofollow" href="https://www.unknowncheats.me/forum/members/5315844.html">View Public Profile</a></td></tr>
	


	
		<tr><td class="vbmenu_option"><a href="https://www.unknowncheats.me/forum/private.php?do=newpm&amp;u=5315844" rel="nofollow">Send a private message to noahsx</a></td></tr>
	
	<!---->
	
		<tr><td class="vbmenu_option"><a href="https://www.unknowncheats.me/forum/search.php?do=finduser&amp;u=5315844" rel="nofollow">Find More Posts by noahsx</a></td></tr>
	
	
	<tr><td class="vbmenu_option"><a rel="nofollow" href="https://www.unknowncheats.me/forum/profile.php?do=addlist&amp;userlist=buddy&amp;u=5315844">Add noahsx to Your Contacts</a></td></tr>
	



</table>
</div>
<!-- / post 4433650 popup menu -->

  <!-- bottom table setup -->
    <table style="width: 100%;" class="thead" cellpadding="0" cellspacing="0">
      <tr>
        <td style="width: 100%; height: 5px;"><img src="ambience/misc/trans.gif"  height="5" alt=" " style="border: 0;"></td>
      </tr>
    </table>
   <!-- End bottom table setup -->




<!-- / post #4433650 -->

<br>

<div style="text-align:center;">
  <div style="margin: 0 auto;">
    <div data-fuse="footer_showthread_showpost"></div>
  </div>
</div>

<br>
<table class="tborder" style="width: 100%; border: 0; border-top-width: 0px; border-collapse: separate; border-spacing: 1px;">
<tr>
	<td class="tfoot" style="padding: 6px; text-align: center;">
		<input type="button" class="button" value="Close this window" id="close_button" style="display: none;" />
		&nbsp;
    <script>
        if (self.opener) {
            var close_button = document.getElementById('close_button');
            close_button.style.display = '';
            close_button.onclick = function() { self.close(); };
        }
    </script>
	</td>
</tr>
</table>

</form>


<!-- lightbox scripts -->
	<script type="text/javascript" src="clientscript/vbulletin_lightbox.js?v=387"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "td_post_4433650", 1);
	//-->
	</script>
<!-- / lightbox scripts -->


<script>
<!--
	// Main vBulletin Javascript Initialization
	vBulletin_init();
//-->
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"26620702b9c543bf96adadc28009a875","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>